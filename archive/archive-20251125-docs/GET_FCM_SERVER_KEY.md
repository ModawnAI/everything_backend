# How to Get FCM Server Key
## Visual Step-by-Step Guide

---

## ğŸ¯ **What You Need**

**FCM Server Key** from Firebase Console - This is the ONLY thing missing to complete your push notification setup!

---

## ğŸ“‹ **Step-by-Step Instructions**

### **Step 1: Open Firebase Console**

ğŸ”— **Go to:** [https://console.firebase.google.com](https://console.firebase.google.com)

---

### **Step 2: Select Project**

Look for and click on: **e-beautything**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Firebase Console                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  My Projects                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  e-beautything         â”‚ â† Click    â”‚
â”‚  â”‚  Project ID: e-beautything         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Step 3: Open Project Settings**

Click the **âš™ï¸ Settings** icon in the top-left corner

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ Settings  â˜°  e-beautything         â”‚ â† Click gear icon
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Click dropdown that appears:           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Project settings    â”‚ â† Click this  â”‚
â”‚  â”‚ Users and permissionsâ”‚               â”‚
â”‚  â”‚ Usage and billing    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Step 4: Navigate to Cloud Messaging Tab**

In Project Settings, click the **Cloud Messaging** tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Project Settings                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  General | Users | Service accounts |   â”‚
â”‚  Cloud Messaging | Integrations         â”‚
â”‚      â†‘                                  â”‚
â”‚  Click this tab                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Step 5: Enable Cloud Messaging API (If Needed)**

If you see this message:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ Cloud Messaging API is disabled     â”‚
â”‚                                         â”‚
â”‚  [Enable API]  â† Click this button     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Click **Enable API** and wait ~30 seconds.

---

### **Step 6: Find Server Key**

Scroll down to find the section:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cloud Messaging API (Legacy)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Server key                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ AAAA...xxxxx...xxxxx            â”‚   â”‚
â”‚  â”‚ (Long key starting with AAAA)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 [Copy] â† Click          â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Copy the entire key!** It should look like:
```
AAAAxxxxxxx:APA91bHxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

---

### **Step 7: Update .env File**

Open `/home/bitnami/everything_backend/.env` and find this line:

```bash
FCM_SERVER_KEY=your-fcm-server-key-here
```

Replace with your actual key:

```bash
FCM_SERVER_KEY=AAAA_paste_your_copied_key_here
```

**Example:**
```bash
FCM_SERVER_KEY=AAAAxxxxxxx:APA91bHPqL8JxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxGWXSsUX
```

---

### **Step 8: Save and Restart Backend**

```bash
# Save the .env file, then restart:
cd /home/bitnami/everything_backend
npm run dev:clean
```

Or with PM2:
```bash
pm2 restart backend
```

---

### **Step 9: Verify It's Working**

Check logs:
```bash
tail -f logs/combined.log | grep "Firebase"
```

âœ… **Success! You should see:**
```
[INFO] Firebase Admin SDK initialized successfully { projectId: 'e-beautything' }
```

---

## ğŸš¨ **Common Issues**

### **Issue 1: "Cloud Messaging API (Legacy)" section not visible**

**Solution:**
1. Make sure you're in the **Cloud Messaging** tab (not General or Service accounts)
2. Scroll down - it might be below other settings
3. If still not visible, the API might need to be enabled first

---

### **Issue 2: "Cloud Messaging API is disabled"**

**Solution:**
1. Click **Enable API** button
2. Wait 30 seconds
3. Refresh the page
4. Server key should now be visible

---

### **Issue 3: Server key field is empty**

**Solution:**
1. Check if you have proper permissions (Owner or Editor role)
2. Try refreshing the page
3. Contact Firebase project administrator if you don't have permissions

---

### **Issue 4: "I can't find the Settings icon"**

**Solution:**
1. Look at the **top-left** corner of Firebase Console
2. It's a âš™ï¸ gear/cog icon next to your project name
3. Click it to reveal dropdown menu

---

## ğŸ“± **Alternative: Using Firebase CLI**

If you have Firebase CLI installed:

```bash
# Login to Firebase
firebase login

# Get server key (requires jq)
firebase projects:list | grep e-beautything

# Note: Server key retrieval via CLI requires additional setup
# Recommended to use Console UI (steps above)
```

---

## ğŸ¯ **What Happens After You Add the Key?**

1. **Backend initializes Firebase Admin SDK** with your server key
2. **Admin can send push notifications** via `/api/admin/push/send`
3. **Mobile apps can register FCM tokens** via `/api/notifications/register`
4. **Push notifications work end-to-end** ğŸ‰

---

## ğŸ“Š **Visual Summary**

```
Firebase Console
    â†“
Select Project (e-beautything)
    â†“
âš™ï¸ Settings â†’ Project Settings
    â†“
Cloud Messaging Tab
    â†“
Enable API (if needed)
    â†“
Scroll to "Cloud Messaging API (Legacy)"
    â†“
Copy Server Key (starts with AAAA)
    â†“
Paste in .env file
    â†“
Restart Backend
    â†“
âœ… Done!
```

---

## ğŸ†˜ **Still Having Issues?**

1. **Check logs:**
   ```bash
   tail -f logs/error.log
   ```

2. **Verify project ID:**
   ```bash
   grep FCM_PROJECT_ID .env
   # Should show: FCM_PROJECT_ID=e-beautything
   ```

3. **Test backend is running:**
   ```bash
   curl http://localhost:3001/health
   ```

4. **Check Firebase project permissions:**
   - Go to Firebase Console â†’ Project Settings â†’ Users and permissions
   - Make sure you have "Owner" or "Editor" role

---

## ğŸ“š **Next Steps After Getting Key**

1. âœ… Restart backend
2. âœ… Test push notification sending (see [FIREBASE_SETUP_STATUS.md](./FIREBASE_SETUP_STATUS.md))
3. âœ… Configure Flutter mobile app
4. âœ… Test end-to-end notification flow

---

**Time required:** ~5 minutes
**Difficulty:** Easy

**You've got this! ğŸš€**
